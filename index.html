<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>rhmt_tools - DASHBOARD</title>

  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root{
      --bg-body: #f1f5f9;
      --bg-card: #ffffff;
      --text-main: #0f172a;
      --text-secondary: #64748b;

      --bg-sidebar: #111827;
      --sidebar-surface: rgba(255,255,255,0.06);
      --sidebar-surface-hover: rgba(255,255,255,0.12);

      --primary: #334155;
      --primary-soft: rgba(51,65,85,0.12);

      --btn-dark-bg: #334155;
      --btn-dark-border: #334155;
      --btn-dark-text: #ffffff;

      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;

      --border: #e2e8f0;
      --shadow-card: 0 6px 18px rgba(15, 23, 42, 0.08);
      --radius: 16px;

      --wa-green: #25D366;
      --wa-green-dark: #1fb85a;
      --wa-text: #0b1220;
    }

    [data-theme="dark"]{
      --bg-body: #0b1220;
      --bg-card: #0f172a;
      --text-main: #e5e7eb;
      --text-secondary: rgba(229,231,235,0.70);

      --border: rgba(148,163,184,0.18);
      --shadow-card: 0 10px 26px rgba(0,0,0,0.35);

      --primary: #cbd5e1;
      --primary-soft: rgba(203,213,225,0.10);

      --btn-dark-bg: rgba(203,213,225,0.88);
      --btn-dark-border: rgba(203,213,225,0.88);
      --btn-dark-text: #0b1220;

      --wa-text: #0b1220;
    }

    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family:'Plus Jakarta Sans',sans-serif;
      background:var(--bg-body);
      color:var(--text-main);
      display:flex;
      min-height:100vh;
      overflow-x:hidden;
      transition: background .2s ease, color .2s ease;
    }

    .sidebar{
      width:280px;
      background:var(--bg-sidebar);
      color:#f8fafc;
      padding:16px 18px;
      display:flex;
      flex-direction:column;
      position:fixed;
      top:0;left:0;
      height:100vh;
      z-index:1000;
      transition:transform .3s ease;
    }

    .sidebar-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:10px;
    }
    .brand-box{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight:900;
      font-size:1.08rem;
      letter-spacing:.2px;
      padding-top:2px;
    }
    .brand-box i{color:#cbd5e1;font-size:1.2rem}

    .nav-menu{
      list-style:none;
      padding:0;margin:0;
      display:flex;
      flex-direction:column;
      gap:10px;
      flex: 1 1 auto;
      min-height: 0;
    }
    .nav-label{
      font-size:.75rem;
      font-weight:800;
      color:rgba(248,250,252,0.6);
      letter-spacing:.08em;
      margin:12px 8px 6px;
      text-transform:uppercase;
    }
    .nav-item{width:100%}
    .nav-btn{
      width:100%;
      display:flex;
      align-items:center;
      gap:10px;
      padding:12px 12px;
      border-radius:12px;
      border:none;
      background:var(--sidebar-surface);
      color:#f8fafc;
      cursor:pointer;
      font-weight:800;
      transition:.2s;
    }
    .nav-btn:hover{background:var(--sidebar-surface-hover)}
    .nav-btn .arrow{margin-left:auto;transition:.2s}
    .nav-btn.active-dropdown .arrow{transform:rotate(180deg)}

    .dropdown-menu{
      display:none;
      margin-top:8px;
      padding-left:8px;
      flex-direction:column;
      gap:8px;
    }
    .dropdown-menu.active{display:flex}
    .dropdown-btn{
      width:100%;
      display:flex;
      align-items:center;
      gap:10px;
      padding:11px 12px;
      border-radius:12px;
      border:none;
      background: rgba(255,255,255,0.04);
      color:#f8fafc;
      cursor:pointer;
      font-weight:800;
      transition:.2s;
    }
    .dropdown-btn:hover{background: rgba(255,255,255,0.10)}

    .sidebar-spacer{
      flex: 1 1 auto;
      min-height: 10px;
    }

    .sidebar-account{
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid rgba(255,255,255,0.08);
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .sidebar-profile{
      display:flex;
      align-items:center;
      gap:12px;
      padding:12px;
      border-radius:14px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.08);
      cursor:pointer;
      transition:.2s;
      user-select:none;
    }
    .sidebar-profile:hover{
      background: rgba(255,255,255,0.08);
      transform: translateY(-1px);
    }
    .avatar{
      width:44px;height:44px;
      border-radius:999px;
      object-fit:cover;
      object-position:center;
      border: 2px solid rgba(203,213,225,0.25);
      background:#0b1220;
      flex:0 0 auto;
    }
    .sp-meta{display:flex;flex-direction:column;line-height:1.12}
    .sp-name{font-weight:900;font-size:.95rem;color:#f8fafc}
    .sp-tag{
      margin-top:4px;
      font-weight:800;
      font-size:.78rem;
      color:rgba(248,250,252,0.65)
    }
    .copyright{
      font-size:.72rem;
      font-weight:800;
      color: rgba(248,250,252,0.55);
      padding: 0 6px;
    }

    .main-wrapper{
      margin-left:280px;
      padding:22px;
      width:calc(100% - 280px);
    }

    .top-bar{
      background:var(--bg-card);
      border-radius:var(--radius);
      box-shadow:var(--shadow-card);
      padding:16px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:18px;
      border: 1px solid var(--border);
      transition: background .2s ease, border-color .2s ease;
    }

    .mobile-toggle{
      display:none;
      border:none;
      background: var(--primary-soft);
      color: var(--primary);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      font-size:1.1rem;
    }

    .page-title h1{font-size:1.1rem;font-weight:900;margin-bottom:2px}
    .page-title p{font-size:.85rem;color:var(--text-secondary);font-weight:700}

    .profile-badge{
      display:flex;
      align-items:center;
      gap:12px;
      padding:8px 10px;
      border-radius:14px;
      background:rgba(248,250,252,0.92);
      border: 1px solid var(--border);
      cursor:pointer;
      transition:.2s;
      user-select:none;
    }
    [data-theme="dark"] .profile-badge{ background: rgba(2,6,23,0.45); }
    .profile-badge:hover{transform: translateY(-1px)}
    .profile-avatar{
      width:40px;height:40px;border-radius:999px;
      object-fit:cover;object-position:center;
      border: 2px solid rgba(51,65,85,0.18);
      background:#0b1220;
    }
    .profile-meta{display:flex;flex-direction:column;line-height:1.1}
    .profile-name{font-weight:900;font-size:.92rem}
    .profile-role{margin-top:3px;font-weight:800;font-size:.78rem;color:var(--text-secondary)}
    @media (max-width:520px){
      .profile-meta{display:none}
      .profile-badge{padding:8px}
    }

    .tool-section{width:100%;animation: fadeUp .18s ease both;}
    .hidden{display:none!important}
    @keyframes fadeUp{from{opacity:0; transform: translateY(6px)}to{opacity:1; transform: translateY(0)}}

    #profileTool{animation: fadeUpSlow .40s ease both;}
    @keyframes fadeUpSlow{from{opacity:0; transform: translateY(12px)}to{opacity:1; transform: translateY(0)}}

    .overview-card{
      background: linear-gradient(135deg, rgba(51,65,85,0.10), rgba(15,23,42,0.04));
      border-radius:var(--radius);
      padding:18px;
      box-shadow:var(--shadow-card);
      border: 1px solid var(--border);
      margin-bottom:18px;
      transition: background .2s ease, border-color .2s ease;
    }
    [data-theme="dark"] .overview-card{
      background: linear-gradient(135deg, rgba(203,213,225,0.08), rgba(2,6,23,0.25));
    }

    .overview-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      margin-bottom:12px;
    }
    .ov-title{
      display:flex;
      align-items:center;
      gap:12px;
      min-width:0;
    }
    .ov-icon{
      width:44px;height:44px;border-radius:14px;
      display:grid;place-items:center;
      background: rgba(255,255,255,0.55);
      border:1px solid var(--border);
      color: var(--primary);
      flex:0 0 auto;
    }
    [data-theme="dark"] .ov-icon{ background: rgba(2,6,23,0.35); }

    .ov-title h2{
      font-size:1.12rem;
      font-weight:900;
      letter-spacing:.1px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .ov-title p{
      margin-top:2px;
      font-size:.86rem;
      color:var(--text-secondary);
      font-weight:800;
    }

    .clock-chip{
      background: rgba(255,255,255,0.85);
      border:1px solid var(--border);
      border-radius:14px;
      padding:10px 12px;
      min-width: 170px;
      box-shadow: 0 6px 16px rgba(15, 23, 42, 0.06);
      text-align:right;
    }
    [data-theme="dark"] .clock-chip{ background: rgba(2,6,23,0.45); }

    .clock{
      font-family:'JetBrains Mono',monospace;
      font-weight:900;
      color:var(--primary);
      font-size:1.02rem;
    }
    .clock-sub{
      margin-top:4px;
      font-weight:850;
      color:var(--text-secondary);
      font-size:.78rem;
    }

    .overview-body{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:14px;
      align-items:stretch;
    }
    .ov-panel{
      background: rgba(255,255,255,0.55);
      border: 1px solid var(--border);
      border-radius:14px;
      padding:14px;
    }
    [data-theme="dark"] .ov-panel{ background: rgba(2,6,23,0.35); }
    .ov-panel h3{font-size:.9rem;font-weight:900;margin-bottom:6px}
    .ov-panel p{color:var(--text-secondary);font-weight:750;line-height:1.35;font-size:.9rem}

    .ov-kpis{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:10px;
    }
    .kpi{
      background: rgba(255,255,255,0.55);
      border:1px solid var(--border);
      border-radius:14px;
      padding:12px;
    }
    [data-theme="dark"] .kpi{ background: rgba(2,6,23,0.35); }
    .kpi .k{font-weight:900;color:var(--text-secondary);font-size:.76rem;margin-bottom:6px}
    .kpi .v{font-family:'JetBrains Mono',monospace;font-weight:900;font-size:1rem;color:var(--text-main)}

    @media (max-width:900px){.overview-body{grid-template-columns:1fr}}
    @media (max-width:520px){
      .overview-head{flex-direction:column;align-items:stretch}
      .clock-chip{min-width:100%;text-align:left}
      .ov-title h2{white-space:normal}
    }

    .dashboard-content{
      display:grid;
      grid-template-columns:repeat(2,minmax(0,1fr));
      gap:18px;
    }
    @media (max-width:1000px){.dashboard-content{grid-template-columns:1fr}}

    .dashboard-card{
      background:var(--bg-card);
      border-radius:var(--radius);
      box-shadow:var(--shadow-card);
      padding:18px;
      border: 1px solid var(--border);
      transition: background .2s ease, border-color .2s ease;
    }

    .card-header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
    .card-icon{
      width:42px;height:42px;border-radius:14px;
      display:grid;place-items:center;
      background: var(--primary-soft);
      color: var(--primary);
      font-size:1.15rem;
    }
    .card-title{font-size:1rem;font-weight:900}
    .card-body p{color:var(--text-secondary);font-weight:700;font-size:.9rem}

    .chip-row{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
    .chip{
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background:rgba(248,250,252,0.92);
      font-weight:900;
      font-size:.78rem;
      color:var(--text-main);
    }
    [data-theme="dark"] .chip{ background: rgba(2,6,23,0.35); }

    .quick-actions{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px}
    .qa-btn{
      border:1px solid var(--border);
      background:rgba(248,250,252,0.92);
      border-radius:12px;
      padding:10px 12px;
      font-weight:900;
      cursor:pointer;
      display:flex;
      align-items:center;
      gap:8px;
      transition:.2s;
    }
    [data-theme="dark"] .qa-btn{ background: rgba(2,6,23,0.35); }
    .qa-btn:hover{transform:translateY(-1px)}
    .qa-btn.primary{
      background: var(--btn-dark-bg);
      border-color: var(--btn-dark-border);
      color: var(--btn-dark-text);
    }

    .link-btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding:11px 14px;
      border-radius:12px;
      border:1px solid var(--border);
      background:rgba(248,250,252,0.92);
      font-weight:900;
      text-decoration:none;
      color:var(--text-main);
      transition:.2s;
      margin-top:12px;
      width: fit-content;
    }
    [data-theme="dark"] .link-btn{ background: rgba(2,6,23,0.35); }
    .link-btn:hover{transform:translateY(-1px)}

    .link-btn.whatsapp{
      background: var(--wa-green);
      border-color: var(--wa-green);
      color: var(--wa-text);
    }
    .link-btn.whatsapp:hover{
      background: var(--wa-green-dark);
      border-color: var(--wa-green-dark);
    }

    .chart-wrap{display:grid;grid-template-columns: 1fr;gap:12px;margin-top:10px}
    .chart-box{
      border:1px solid var(--border);
      background:rgba(248,250,252,0.92);
      border-radius:14px;
      padding:14px;
      overflow:hidden;
    }
    [data-theme="dark"] .chart-box{ background: rgba(2,6,23,0.35); }
    .chart-top{display:flex;align-items:flex-end;justify-content:space-between;gap:12px;margin-bottom:10px}
    .chart-top .label{font-weight:900}
    .chart-top .hint{font-weight:800;color:var(--text-secondary);font-size:.8rem}

    /* ===== UPDATED GRAPH STYLE (still consistent) ===== */
    .bars{
      display:flex;
      align-items:flex-end;
      gap:10px;
      height:160px;
      padding:12px 10px;
      border-radius:12px;
      background:rgba(255,255,255,0.80);
      border: 1px dashed rgba(148,163,184,0.45);
      overflow-x:auto;
    }
    [data-theme="dark"] .bars{ background: rgba(2,6,23,0.22); }

    .bar-item{flex:1 1 0;min-width:86px;display:flex;flex-direction:column;gap:8px}
    .bar-col{height:100%;display:flex;align-items:flex-end;justify-content:center}
    .bar{
      width:100%;
      height:20%;
      border-radius:12px 12px 8px 8px;
      background: rgba(51,65,85,0.20);
      position:relative;
      overflow:hidden;
      border: 1px solid rgba(51,65,85,0.10);
      transition: height .25s ease;
      display:flex;
      align-items:flex-start;
      justify-content:flex-start;
    }
    [data-theme="dark"] .bar{ background: rgba(203,213,225,0.10); border-color: rgba(148,163,184,0.18); }

    .bar span{
      font-family:'JetBrains Mono',monospace;
      font-weight:900;
      font-size:.82rem;
      color:var(--text-main);
      background: rgba(255,255,255,0.85);
      border:1px solid var(--border);
      border-radius:999px;
      padding:4px 8px;
      margin:8px;
    }
    [data-theme="dark"] .bar span{ background: rgba(2,6,23,0.55); }

    .bar-label{text-align:center;font-weight:900;font-size:.78rem;color: var(--text-secondary);line-height:1.2}

    .mini-metrics{
      display:grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap:10px;
      margin-top:10px;
    }
    @media (max-width:520px){.mini-metrics{grid-template-columns:1fr}}
    .mini{
      border:1px solid var(--border);
      background:rgba(255,255,255,0.85);
      border-radius:14px;
      padding:12px;
    }
    [data-theme="dark"] .mini{ background: rgba(2,6,23,0.35); }
    .mini .k{font-size:.78rem;font-weight:900;color:var(--text-secondary);margin-bottom:6px}
    .mini .v{font-family:'JetBrains Mono',monospace;font-weight:900;font-size:1.05rem;color: var(--text-main)}

    .profile-card{padding:0;overflow:hidden}
    .profile-hero{position:relative;height:160px;background:#0b1220;border-bottom:1px solid var(--border)}
    .profile-hero::before{
      content:"";position:absolute; inset:0;
      background-image:url('https://j.top4top.io/p_36895t2sb0.jpeg');
      background-size:cover;background-position:center;
      transform: scale(1.02);
    }
    .profile-hero::after{
      content:"";position:absolute; inset:0;
      background: linear-gradient(180deg, rgba(15,23,42,0.10) 0%, rgba(15,23,42,0.35) 100%);
    }
    .profile-body{padding:18px;padding-top:64px;background: var(--bg-card)}
    .profile-avatar-wrap{
      position:absolute;left:50%;bottom:-46px;transform:translateX(-50%);
      width:96px;height:96px;border-radius:999px;background: #fff;
      border: 1px solid var(--border);
      display:grid;place-items:center;
      box-shadow: 0 10px 24px rgba(15, 23, 42, 0.12);
      z-index:2;
    }
    [data-theme="dark"] .profile-avatar-wrap{ background: rgba(2,6,23,0.65); }
    .profile-avatar-big{
      width:88px;height:88px;border-radius:999px;object-fit:cover;
      border:3px solid rgba(51,65,85,0.12);background:#0b1220;
    }
    .profile-center{display:flex;flex-direction:column;align-items:center;text-align:center;gap:10px}
    .profile-name-big{margin-top:2px;font-weight:900;font-size:1.15rem;letter-spacing:.2px}
    .profile-desc{max-width:720px;color:var(--text-secondary);font-weight:750;line-height:1.5;font-size:.96rem}

    .stat-grid-2{margin-top:16px;display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
    @media (max-width:520px){.stat-grid-2{grid-template-columns:1fr}}
    .stat-card{
      border:1px solid var(--border);
      border-radius:14px;
      padding:14px;
      background:rgba(248,250,252,0.92);
    }
    [data-theme="dark"] .stat-card{ background: rgba(2,6,23,0.35); }
    .stat-card .k{color:var(--text-secondary);font-weight:900;font-size:.78rem;margin-bottom:8px;letter-spacing:.02em}
    .stat-card .v{font-family:'JetBrains Mono',monospace;font-weight:900;font-size:1.05rem;color:var(--text-main)}

    .settings-grid{display:grid;grid-template-columns: 1fr;gap:12px}
    .setting-row{
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      padding:12px;border:1px solid var(--border);border-radius:14px;
      background:rgba(248,250,252,0.92);
    }
    [data-theme="dark"] .setting-row{ background: rgba(2,6,23,0.35); }
    .setting-left{display:flex;align-items:center;gap:10px}
    .setting-ic{
      width:40px;height:40px;border-radius:14px;
      display:grid;place-items:center;
      background: var(--primary-soft);color: var(--primary);
    }
    .setting-title{font-weight:900}
    .setting-desc{font-size:.82rem;color:var(--text-secondary);font-weight:800;margin-top:2px}

    .switch{position:relative;width:46px;height:26px;flex:0 0 auto}
    .switch input{display:none}
    .slider{
      position:absolute; inset:0;border-radius:999px;
      background: rgba(148,163,184,0.35);
      border:1px solid var(--border);
      transition:.2s;cursor:pointer;
    }
    .slider::after{
      content:"";
      position:absolute; top:3px; left:3px;
      width:20px; height:20px;
      border-radius:999px;
      background: rgba(255,255,255,0.95);
      box-shadow: 0 6px 14px rgba(15,23,42,0.18);
      transition:.2s;
    }
    .switch input:checked + .slider{background: rgba(51,65,85,0.55)}
    .switch input:checked + .slider::after{transform: translateX(20px)}

    .tool-grid{display:grid;grid-template-columns:1.2fr .8fr;gap:18px;align-items:start}
    @media (max-width:900px){.tool-grid{grid-template-columns:1fr}}
    .tool-label{display:block;font-weight:800;font-size:.9rem;margin-bottom:8px}
    .tool-input{
      width:100%;padding:12px 14px;border-radius:12px;border:1px solid var(--border);
      background:rgba(255,255,255,0.92);
      font-family:'JetBrains Mono',monospace;font-size:.85rem;outline:none;color: var(--text-main);
    }
    [data-theme="dark"] .tool-input{ background: rgba(2,6,23,0.35); }
    .tool-row{display:flex;gap:10px;align-items:center}
    @media (max-width:520px){.tool-row{flex-direction:column;align-items:stretch}}
    .tool-btn{
      padding:10px 14px;border-radius:12px;border:1px solid var(--border);
      background:rgba(248,250,252,0.92);
      color:var(--text-main);font-weight:900;cursor:pointer;transition:.2s;white-space:nowrap;
    }
    [data-theme="dark"] .tool-btn{ background: rgba(2,6,23,0.35); }
    .tool-btn:hover{transform:translateY(-1px)}
    .tool-btn.primary{
      background: var(--btn-dark-bg);
      border-color: var(--btn-dark-border);
      color: var(--btn-dark-text);
      margin-top:10px;
    }
    .tool-btn:disabled{opacity:.7;cursor:not-allowed;transform:none}
    .tool-status{margin-top:10px;font-size:.9rem;color:var(--text-secondary);min-height:22px}
    .tool-status.success{color:var(--success);font-weight:900}
    .tool-status.error{color:var(--danger);font-weight:900}
    .preview-box{
      border:1px dashed rgba(148,163,184,0.45);
      border-radius:14px;padding:14px;background:rgba(248,250,252,0.92);
    }
    [data-theme="dark"] .preview-box{ background: rgba(2,6,23,0.35); }
    .preview-title{font-weight:900;margin-bottom:10px;color:var(--text-secondary)}
    .preview-empty{color:var(--text-secondary);font-size:.9rem;font-weight:750}
    .preview-media{width:100%;max-height:260px;border-radius:14px;background:#0b1220}
    img.preview-media{object-fit:contain;background:transparent}
    .shimmer{position:relative;overflow:hidden;border-radius:12px}
    .shimmer::after{
      content:"";position:absolute; inset:-40%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.25), transparent);
      transform: translateX(-60%);
      animation: shimmerMove 1.1s linear infinite;
    }
    [data-theme="dark"] .shimmer::after{
      background: linear-gradient(90deg, transparent, rgba(203,213,225,0.18), transparent);
    }
    @keyframes shimmerMove{to{transform: translateX(60%)}}

    @media (max-width:768px){
      .sidebar{transform:translateX(-100%)}
      .sidebar.active{transform:translateX(0)}
      .main-wrapper{margin-left:0;width:100%}
      .mobile-toggle{display:inline-flex}
    }
  </style>
</head>

<body>
  <nav class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <div class="brand-box">
        <i class="fa-solid fa-layer-group"></i>
        <span>rhmt_tools</span>
      </div>
    </div>

    <ul class="nav-menu">
      <div class="nav-label">MENU</div>

      <li class="nav-item">
        <button class="nav-btn" onclick="showTool('dashboard')">
          <i class="fa-solid fa-gauge"></i> Dashboard
        </button>
      </li>

      <div class="nav-label" style="margin-top: 20px;">TO URL</div>

      <li class="nav-item">
        <button class="nav-btn" id="uploaderBtn" onclick="toggleUploaderDropdown()">
          <i class="fa-solid fa-cloud-arrow-up"></i> Uploader
          <i class="fas fa-chevron-down arrow"></i>
        </button>

        <div class="dropdown-menu" id="uploaderDropdown">
          <div class="dropdown-item">
            <button class="dropdown-btn" onclick="showTool('img')">
              <i class="fa-solid fa-image"></i> Img to URL
            </button>
          </div>
          <div class="dropdown-item">
            <button class="dropdown-btn" onclick="showTool('vid')">
              <i class="fa-solid fa-video"></i> Vid to URL
            </button>
          </div>
          <div class="dropdown-item">
            <button class="dropdown-btn" onclick="showTool('aud')">
              <i class="fa-solid fa-music"></i> Aud to URL
            </button>
          </div>
        </div>
      </li>

      <li class="nav-item" style="margin-top: 10px;">
        <button class="nav-btn" onclick="showTool('settings')">
          <i class="fa-solid fa-gear"></i> Settings
        </button>
      </li>

      <div class="sidebar-spacer"></div>

      <div class="sidebar-account">
        <div class="sidebar-profile" onclick="showTool('profile')">
          <img class="avatar" src="https://a.top4top.io/p_36880pr920.jpeg" alt="avatar" referrerpolicy="no-referrer" />
          <div class="sp-meta">
            <div class="sp-name">R_hmt ofc</div>
            <div class="sp-tag">Student • Web Development</div>
          </div>
        </div>

        <div class="copyright">© Hak cipta dilindungi.</div>
      </div>
    </ul>
  </nav>

  <div class="main-wrapper">
    <header class="top-bar">
      <div style="display:flex;align-items:center;gap:15px;">
        <button class="mobile-toggle" onclick="toggleSidebar()"><i class="fa-solid fa-bars"></i></button>
        <div class="page-title">
          <h1>Dashboard</h1>
          <p>Welcome to rhmt_tools management panel</p>
        </div>
      </div>

      <div class="profile-badge" onclick="showTool('profile')">
        <img class="profile-avatar" src="https://a.top4top.io/p_36880pr920.jpeg" alt="Profile" referrerpolicy="no-referrer" />
        <div class="profile-meta">
          <div class="profile-name">R_hmt ofc</div>
          <div class="profile-role">Kelas XI MA • Web Dev</div>
        </div>
      </div>
    </header>

    <section id="dashboardTool" class="tool-section">
      <div class="overview-card">
        <div class="overview-head">
          <div class="ov-title">
            <div class="ov-icon" aria-hidden="true">
              <i class="fa-solid fa-gauge-high"></i>
            </div>
            <div style="min-width:0;">
              <h2>Dashboard Overview</h2>
              <p>Ringkasan singkat dan akses cepat ke fitur utama.</p>
            </div>
          </div>

          <div class="clock-chip">
            <div class="clock" id="clockText">--:--:--</div>
            <div class="clock-sub" id="clockSub">--</div>
          </div>
        </div>

        <div class="overview-body">
          <div class="ov-panel">
            <h3>What you can do</h3>
            <p>
              Gunakan menu “Uploader” untuk mengunggah gambar, video, atau audio.
              Setelah berhasil, tautan URL tersedia dan dapat disalin dengan satu klik.
            </p>
          </div>

          <div class="ov-kpis">
            <div class="kpi">
              <div class="k">STATUS</div>
              <div class="v" id="kpiStatus">—</div>
            </div>
            <div class="kpi">
              <div class="k">TOTAL VISITORS</div>
              <div class="v" id="kpiTotal">—</div>
            </div>
            <div class="kpi">
              <div class="k">ACTIVE NOW</div>
              <div class="v" id="kpiActive">—</div>
            </div>
            <div class="kpi">
              <div class="k">UPLOADS TODAY</div>
              <div class="v" id="kpiUploads">—</div>
            </div>
          </div>
        </div>
      </div>

      <div class="dashboard-content">
        <div class="dashboard-card">
          <div class="card-header">
            <div class="card-icon"><i class="fa-solid fa-wand-magic-sparkles"></i></div>
            <div class="card-title">Quick Actions</div>
          </div>
          <div class="card-body">
            <p>Pilih tool yang ingin digunakan:</p>
            <div class="quick-actions">
              <button class="qa-btn primary" onclick="showTool('img')"><i class="fa-solid fa-image"></i> Img to URL</button>
              <button class="qa-btn" onclick="showTool('vid')"><i class="fa-solid fa-video"></i> Vid to URL</button>
              <button class="qa-btn" onclick="showTool('aud')"><i class="fa-solid fa-music"></i> Aud to URL</button>
              <button class="qa-btn" onclick="showTool('profile')"><i class="fa-solid fa-user"></i> Profile</button>
            </div>
            <div class="chip-row">
              <div class="chip">Static Frontend</div>
              <div class="chip">Vanilla JS</div>
              <div class="chip">Fast Workflow</div>
            </div>
          </div>
        </div>

        <div class="dashboard-card">
          <div class="card-header">
            <div class="card-icon"><i class="fa-brands fa-whatsapp"></i></div>
            <div class="card-title">Join Saluran WhatsApp</div>
          </div>
          <div class="card-body">
            <p>
              Join saluran WhatsApp kami untuk update informasi teknologi, tools web, APK, Termux, dan tools lainnya.
            </p>
            <a class="link-btn whatsapp" href="https://whatsapp.com/channel/0029VbBjyjlJ93wa6hwSWa0p" target="_blank" rel="noopener">
              <i class="fa-brands fa-whatsapp"></i> Join Channel
            </a>
          </div>
        </div>

        <!-- ===== UPDATED GRAPH #1: VISITORS ===== -->
        <div class="dashboard-card">
          <div class="card-header">
            <div class="card-icon"><i class="fa-solid fa-users"></i></div>
            <div class="card-title">Visitors Statistics</div>
          </div>
          <div class="card-body">
            <p>hadeuhh... pembaca pungunnjung web, backend&databasenya ga berfungsi jur gatau knp (skill issue):v</p>

            <div class="chart-wrap">
              <div class="chart-box">
                <div class="chart-top">
                  <div>
                    <div class="label">Visitors</div>
                    <div class="hint">Today • Yesterday • 3 Days • 7 Days • 30 Days</div>
                  </div>
                  <div class="hint" style="font-family:'JetBrains Mono',monospace;">live</div>
                </div>

                <div class="bars">
                  <div class="bar-item">
                    <div class="bar-col">
                      <div class="bar visitor-bar"><span>0</span></div>
                    </div>
                    <div class="bar-label">Today</div>
                  </div>

                  <div class="bar-item">
                    <div class="bar-col">
                      <div class="bar visitor-bar"><span>0</span></div>
                    </div>
                    <div class="bar-label">Yesterday</div>
                  </div>

                  <div class="bar-item">
                    <div class="bar-col">
                      <div class="bar visitor-bar"><span>0</span></div>
                    </div>
                    <div class="bar-label">3 Days</div>
                  </div>

                  <div class="bar-item">
                    <div class="bar-col">
                      <div class="bar visitor-bar"><span>0</span></div>
                    </div>
                    <div class="bar-label">7 Days</div>
                  </div>

                  <div class="bar-item">
                    <div class="bar-col">
                      <div class="bar visitor-bar"><span>0</span></div>
                    </div>
                    <div class="bar-label">30 Days</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="chip-row">
              <div class="chip">Visitors</div>
              <div class="chip">Daily Buckets</div>
              <div class="chip">KV Database</div>
            </div>
          </div>
        </div>

        <!-- ===== UPDATED GRAPH #2: UPLOADS ===== -->
        <div class="dashboard-card">
          <div class="card-header">
            <div class="card-icon"><i class="fa-solid fa-cloud-arrow-up"></i></div>
            <div class="card-title">Uploads Statistics</div>
          </div>
          <div class="card-body">
            <p>Total upload (img / vid / aud) berdasarkan waktu.</p>

            <div class="chart-wrap">
              <div class="chart-box">
                <div class="chart-top">
                  <div>
                    <div class="label">Uploads</div>
                    <div class="hint">Today • Yesterday • 3 Days • 7 Days • 30 Days</div>
                  </div>
                  <div class="hint" style="font-family:'JetBrains Mono',monospace;">live</div>
                </div>

                <div class="bars">
                  <div class="bar-item">
                    <div class="bar-col">
                      <div class="bar upload-bar"><span>0</span></div>
                    </div>
                    <div class="bar-label">Today</div>
                  </div>

                  <div class="bar-item">
                    <div class="bar-col">
                      <div class="bar upload-bar"><span>0</span></div>
                    </div>
                    <div class="bar-label">Yesterday</div>
                  </div>

                  <div class="bar-item">
                    <div class="bar-col">
                      <div class="bar upload-bar"><span>0</span></div>
                    </div>
                    <div class="bar-label">3 Days</div>
                  </div>

                  <div class="bar-item">
                    <div class="bar-col">
                      <div class="bar upload-bar"><span>0</span></div>
                    </div>
                    <div class="bar-label">7 Days</div>
                  </div>

                  <div class="bar-item">
                    <div class="bar-col">
                      <div class="bar upload-bar"><span>0</span></div>
                    </div>
                    <div class="bar-label">30 Days</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="chip-row">
              <div class="chip">Uploads</div>
              <div class="chip">Cloudinary</div>
              <div class="chip">Daily Buckets</div>
            </div>
          </div>
        </div>

        <div class="dashboard-card">
          <div class="card-header">
            <div class="card-icon"><i class="fa-solid fa-lightbulb"></i></div>
            <div class="card-title">Notes</div>
          </div>
          <div class="card-body">
            <p>Catatan penggunaan uploader:</p>
            <div class="chip-row">
              <div class="chip">Unsigned preset wajib</div>
              <div class="chip">Cek ukuran file</div>
              <div class="chip">Copy URL sekali klik</div>
              <div class="chip">Preview sebelum upload</div>
            </div>
          </div>
        </div>

        <div class="dashboard-card">
          <div class="card-header">
            <div class="card-icon"><i class="fa-solid fa-circle-info"></i></div>
            <div class="card-title">System</div>
          </div>
          <div class="card-body">
            <p>Navigasi menggunakan metode hide/show section untuk menjaga performa dan konsistensi tampilan.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="profileTool" class="tool-section hidden">
      <div class="dashboard-card profile-card">
        <div class="profile-hero">
          <div class="profile-avatar-wrap">
            <img class="profile-avatar-big" src="https://a.top4top.io/p_36880pr920.jpeg" alt="avatar" referrerpolicy="no-referrer" />
          </div>
        </div>

        <div class="profile-body">
          <div class="profile-center">
            <div class="profile-name-big">R_hmt ofc</div>
            <div class="profile-desc">
              Siswa kelas XI MA dengan ketertarikan pada bidang teknologi. Memulai dari eksplorasi AI, kemudian memperluas fokus ke pengembangan web.
              Mengutamakan pembuatan antarmuka yang konsisten, rapi, dan mudah digunakan.
            </div>

            <div class="chip-row" style="justify-content:center;">
              <div class="chip">Kelas XI MA</div>
              <div class="chip">Web Development</div>
              <div class="chip">UI / UX</div>
              <div class="chip">Frontend</div>
            </div>
          </div>

          <div class="stat-grid-2">
            <div class="stat-card">
              <div class="k">FOKUS</div>
              <div class="v">UI / UX</div>
            </div>
            <div class="stat-card">
              <div class="k">PROJECT</div>
              <div class="v">rhmt_tools</div>
            </div>
            <div class="stat-card">
              <div class="k">STACK</div>
              <div class="v">HTML • CSS • JS</div>
            </div>
            <div class="stat-card">
              <div class="k">AKTIVITAS</div>
              <div class="v">Upload Tools</div>
            </div>
          </div>

          <div style="margin-top:14px; display:flex; gap:10px; flex-wrap:wrap; justify-content:center;">
            <button class="tool-btn" onclick="showTool('dashboard')"><i class="fa-solid fa-gauge"></i> Back to Dashboard</button>
            <button class="tool-btn" onclick="copyProfileBio()"><i class="fa-regular fa-copy"></i> Copy Bio</button>
          </div>
        </div>
      </div>
    </section>

    <section id="settingsTool" class="tool-section hidden">
      <div class="dashboard-card">
        <div class="card-header">
          <div class="card-icon"><i class="fa-solid fa-gear"></i></div>
          <div class="card-title">Settings</div>
        </div>
        <div class="card-body">
          <p>Pengaturan tampilan dan preferensi dasar.</p>

          <div class="settings-grid" style="margin-top:12px;">
            <div class="setting-row">
              <div class="setting-left">
                <div class="setting-ic"><i class="fa-solid fa-moon"></i></div>
                <div>
                  <div class="setting-title">Tema Gelap</div>
                  <div class="setting-desc">Aktifkan mode gelap untuk tampilan yang lebih nyaman.</div>
                </div>
              </div>
              <label class="switch">
                <input id="themeToggle" type="checkbox" />
                <span class="slider"></span>
              </label>
            </div>

            <div class="setting-row">
              <div class="setting-left">
                <div class="setting-ic"><i class="fa-solid fa-wand-magic-sparkles"></i></div>
                <div>
                  <div class="setting-title">Animasi Sederhana</div>
                  <div class="setting-desc">Hidupkan/matikan animasi transisi ringan.</div>
                </div>
              </div>
              <label class="switch">
                <input id="motionToggle" type="checkbox" checked />
                <span class="slider"></span>
              </label>
            </div>

            <div class="setting-row">
              <div class="setting-left">
                <div class="setting-ic"><i class="fa-solid fa-bars-staggered"></i></div>
                <div>
                  <div class="setting-title">Auto-close Sidebar (Mobile)</div>
                  <div class="setting-desc">Tutup sidebar otomatis setelah memilih menu.</div>
                </div>
              </div>
              <label class="switch">
                <input id="autoCloseToggle" type="checkbox" checked />
                <span class="slider"></span>
              </label>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="imgTool" class="tool-section hidden"></section>
    <section id="vidTool" class="tool-section hidden"></section>
    <section id="audTool" class="tool-section hidden"></section>
  </div>

  <template id="tplImg">
    <div class="dashboard-card">
      <div class="card-header">
        <div class="card-icon"><i class="fa-solid fa-image"></i></div>
        <div class="card-title">Img to URL (Cloudinary Unsigned)</div>
      </div>
      <div class="card-body">
        <div class="tool-grid">
          <div>
            <label class="tool-label">Pilih Gambar</label>
            <input id="imgFile" class="tool-input" type="file" accept="image/*" />
            <button id="imgUploadBtn" class="tool-btn primary" onclick="uploadImg()">Upload</button>
            <div id="imgStatus" class="tool-status"></div>

            <label class="tool-label" style="margin-top:12px;">Hasil URL</label>
            <div class="tool-row">
              <input id="imgUrl" class="tool-input" type="text" readonly placeholder="URL akan muncul di sini" />
              <button class="tool-btn" onclick="copyUrl('imgUrl')"><i class="fa-regular fa-copy"></i> Copy</button>
            </div>
          </div>

          <div>
            <div class="preview-box">
              <div class="preview-title">Preview</div>
              <img id="imgPreview" class="preview-media hidden" alt="preview" />
              <div id="imgPreviewEmpty" class="preview-empty">Belum ada gambar dipilih.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </template>

  <template id="tplVid">
    <div class="dashboard-card">
      <div class="card-header">
        <div class="card-icon"><i class="fa-solid fa-video"></i></div>
        <div class="card-title">Vid to URL (Cloudinary Unsigned)</div>
      </div>
      <div class="card-body">
        <div class="tool-grid">
          <div>
            <label class="tool-label">Pilih Video</label>
            <input id="vidFile" class="tool-input" type="file" accept="video/*" />
            <button id="vidUploadBtn" class="tool-btn primary" onclick="uploadVid()">Upload</button>
            <div id="vidStatus" class="tool-status"></div>

            <label class="tool-label" style="margin-top:12px;">Hasil URL</label>
            <div class="tool-row">
              <input id="vidUrl" class="tool-input" type="text" readonly placeholder="URL akan muncul di sini" />
              <button class="tool-btn" onclick="copyUrl('vidUrl')"><i class="fa-regular fa-copy"></i> Copy</button>
            </div>
          </div>

          <div>
            <div class="preview-box">
              <div class="preview-title">Preview</div>
              <video id="vidPreview" class="preview-media hidden" controls></video>
              <div id="vidPreviewEmpty" class="preview-empty">Belum ada video dipilih.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </template>

  <template id="tplAud">
    <div class="dashboard-card">
      <div class="card-header">
        <div class="card-icon"><i class="fa-solid fa-music"></i></div>
        <div class="card-title">Aud to URL (Cloudinary Unsigned)</div>
      </div>
      <div class="card-body">
        <div class="tool-grid">
          <div>
            <label class="tool-label">Pilih Audio</label>
            <input id="audFile" class="tool-input" type="file" accept="audio/*" />
            <button id="audUploadBtn" class="tool-btn primary" onclick="uploadAud()">Upload</button>
            <div id="audStatus" class="tool-status"></div>

            <label class="tool-label" style="margin-top:12px;">Hasil URL</label>
            <div class="tool-row">
              <input id="audUrl" class="tool-input" type="text" readonly placeholder="URL akan muncul di sini" />
              <button class="tool-btn" onclick="copyUrl('audUrl')"><i class="fa-regular fa-copy"></i> Copy</button>
            </div>
          </div>

          <div>
            <div class="preview-box">
              <div class="preview-title">Preview</div>
              <audio id="audPreview" class="preview-media hidden" controls></audio>
              <div id="audPreviewEmpty" class="preview-empty">Belum ada audio dipilih.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </template>

  <script>
    const CLOUD_NAME = "dwiozm4vz";
    const UPLOAD_PRESET = "video_unsignedd";
    const IMGBB_API_KEY = "YOUR_IMGBB_KEY";

    const PREF_THEME = "rhmt_theme";
    const PREF_MOTION = "rhmt_motion";
    const PREF_AUTOCLOSE = "rhmt_autoclose";

    function applyTheme(theme){
      document.documentElement.setAttribute("data-theme", theme);
      localStorage.setItem(PREF_THEME, theme);
    }
    function applyMotion(enabled){
      localStorage.setItem(PREF_MOTION, enabled ? "on" : "off");
      const style = document.getElementById("motionStyle");
      if(!enabled){
        if(!style){
          const s = document.createElement("style");
          s.id = "motionStyle";
          s.textContent = ".tool-section{animation:none!important}.bar{transition:none!important}";
          document.head.appendChild(s);
        }
      }else{
        if(style) style.remove();
      }
    }
    function applyAutoClose(enabled){
      localStorage.setItem(PREF_AUTOCLOSE, enabled ? "on" : "off");
    }
    function getAutoClose(){
      return localStorage.getItem(PREF_AUTOCLOSE) !== "off";
    }

    function toggleSidebar(){
      const sidebar=document.getElementById('sidebar');
      sidebar.classList.toggle('active');
      if(!sidebar.classList.contains('active')) closeUploaderDropdown();
    }
    function closeSidebar(){
      document.getElementById('sidebar').classList.remove('active');
      closeUploaderDropdown();
    }

    function toggleUploaderDropdown(){
      const dropdown=document.getElementById('uploaderDropdown');
      const btn=document.getElementById('uploaderBtn');
      dropdown.classList.toggle('active');
      btn.classList.toggle('active-dropdown');
      if(window.innerWidth<=768) document.getElementById('sidebar').classList.add('active');
    }
    function closeUploaderDropdown(){
      document.getElementById('uploaderDropdown').classList.remove('active');
      document.getElementById('uploaderBtn').classList.remove('active-dropdown');
    }
    document.addEventListener('click', (e)=>{
      const dropdown=document.getElementById('uploaderDropdown');
      const btn=document.getElementById('uploaderBtn');
      if(!btn.contains(e.target) && !dropdown.contains(e.target)) closeUploaderDropdown();
    });

    function showTool(tool){
      closeUploaderDropdown();
      const sections = ['dashboardTool','profileTool','settingsTool','imgTool','vidTool','audTool'];
      sections.forEach(id => document.getElementById(id).classList.add('hidden'));

      const map={
        dashboard:{id:'dashboardTool',title:'Dashboard',desc:'Welcome to rhmt_tools management panel'},
        profile:{id:'profileTool',title:'Profile',desc:'Informasi singkat'},
        settings:{id:'settingsTool',title:'Settings',desc:'Pengaturan tampilan dan preferensi'},
        img:{id:'imgTool',title:'Img to URL',desc:'Upload image via Cloudinary unsigned upload'},
        vid:{id:'vidTool',title:'Vid to URL',desc:'Upload video via Cloudinary unsigned upload'},
        aud:{id:'audTool',title:'Aud to URL',desc:'Upload audio via Cloudinary unsigned upload'},
      };

      const chosen=map[tool]||map.dashboard;
      document.getElementById(chosen.id).classList.remove('hidden');

      const h1=document.querySelector('.page-title h1');
      const p=document.querySelector('.page-title p');
      if(h1) h1.textContent=chosen.title;
      if(p) p.textContent=chosen.desc;

      if(window.innerWidth<=768 && getAutoClose()) closeSidebar();
    }

    function setStatus(el,msg,type){
      el.classList.remove('success','error');
      if(type) el.classList.add(type);
      el.textContent=msg||'';
    }

    function copyUrl(inputId){
      const input = document.getElementById(inputId);
      if(!input || !input.value) return;

      input.focus();
      input.select();
      input.setSelectionRange(0, 99999);

      if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(input.value)
          .then(() => showCopyFeedback(input))
          .catch(() => legacyCopy(input));
      } else {
        legacyCopy(input);
      }
    }
    function legacyCopy(input){
      try{
        const ok = document.execCommand("copy");
        if(ok) showCopyFeedback(input);
        else alert("Tekan lama pada URL lalu pilih Salin.");
      }catch(e){
        alert("Tekan lama pada URL lalu pilih Salin.");
      }
    }
    function showCopyFeedback(input){
      const old = input.value;
      input.value = "✔ Copied!";
      setTimeout(()=>{ input.value = old; }, 900);
    }

    function bindPreview(inputId,mediaId,emptyId){
      const input=document.getElementById(inputId);
      const media=document.getElementById(mediaId);
      const empty=document.getElementById(emptyId);
      if(!input||!media||!empty) return;

      input.addEventListener('change',()=>{
        const file=input.files && input.files[0];
        if(!file){
          media.classList.add('hidden');
          empty.classList.remove('hidden');
          if(media.tagName==='IMG') media.src='';
          else media.removeAttribute('src');
          return;
        }
        const url=URL.createObjectURL(file);
        if(media.tagName==='IMG') media.src=url;
        else { media.src=url; media.load(); }
        media.classList.remove('hidden');
        empty.classList.add('hidden');
      });
    }

    async function uploadCloudinary(file, endpoint){
      const form=new FormData();
      form.append('file',file);
      form.append('upload_preset',UPLOAD_PRESET);

      const res=await fetch(endpoint,{method:'POST',body:form});
      const json=await res.json();
      if(!res.ok || !json?.secure_url) throw new Error(json?.error?.message || 'Upload gagal.');
      return json.secure_url;
    }

    function setLoading(btn, statusEl, loading){
      if(!btn) return;
      btn.disabled = loading;
      if(loading){
        btn.classList.add("shimmer");
        setStatus(statusEl, "Uploading...", null);
      }else{
        btn.classList.remove("shimmer");
      }
    }

    async function uploadImg(){
      const fileInput=document.getElementById('imgFile');
      const btn=document.getElementById('imgUploadBtn');
      const status=document.getElementById('imgStatus');
      const out=document.getElementById('imgUrl');
      const file=fileInput.files && fileInput.files[0];
      if(!file) return setStatus(status,'Pilih file gambar dulu.','error');

      out.value='';
      setLoading(btn, status, true);

      try{
        const endpoint=`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`;
        out.value=await uploadCloudinary(file, endpoint);

        fetch("/api/upload").catch(()=>{});
        loadStats();

        setStatus(status,'Upload sukses!','success');
      }catch(err){
        setStatus(status, err.message || 'Terjadi error saat upload.','error');
      }finally{
        setLoading(btn, status, false);
      }
    }

    async function uploadVid(){
      const fileInput=document.getElementById('vidFile');
      const btn=document.getElementById('vidUploadBtn');
      const status=document.getElementById('vidStatus');
      const out=document.getElementById('vidUrl');
      const file=fileInput.files && fileInput.files[0];
      if(!file) return setStatus(status,'Pilih file video dulu.','error');

      out.value='';
      setLoading(btn, status, true);

      try{
        const endpoint=`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/video/upload`;
        out.value=await uploadCloudinary(file, endpoint);

        fetch("/api/upload").catch(()=>{});
        loadStats();

        setStatus(status,'Upload sukses!','success');
      }catch(err){
        setStatus(status, err.message || 'Terjadi error saat upload.','error');
      }finally{
        setLoading(btn, status, false);
      }
    }

    async function uploadAud(){
      const fileInput=document.getElementById('audFile');
      const btn=document.getElementById('audUploadBtn');
      const status=document.getElementById('audStatus');
      const out=document.getElementById('audUrl');
      const file=fileInput.files && fileInput.files[0];
      if(!file) return setStatus(status,'Pilih file audio dulu.','error');

      out.value='';
      setLoading(btn, status, true);

      try{
        const endpoint=`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/video/upload`;
        out.value=await uploadCloudinary(file, endpoint);

        fetch("/api/upload").catch(()=>{});
        loadStats();

        setStatus(status,'Upload sukses!','success');
      }catch(err){
        setStatus(status, err.message || 'Terjadi error saat upload.','error');
      }finally{
        setLoading(btn, status, false);
      }
    }

    function mountTools(){
      const imgWrap=document.getElementById('imgTool');
      const vidWrap=document.getElementById('vidTool');
      const audWrap=document.getElementById('audTool');

      imgWrap.innerHTML=''; vidWrap.innerHTML=''; audWrap.innerHTML='';
      imgWrap.appendChild(document.getElementById('tplImg').content.cloneNode(true));
      vidWrap.appendChild(document.getElementById('tplVid').content.cloneNode(true));
      audWrap.appendChild(document.getElementById('tplAud').content.cloneNode(true));

      bindPreview('imgFile','imgPreview','imgPreviewEmpty');
      bindPreview('vidFile','vidPreview','vidPreviewEmpty');
      bindPreview('audFile','audPreview','audPreviewEmpty');
    }

    function copyProfileBio(){
      const bio =
        "rhmt — Siswa kelas XI MA dengan ketertarikan pada teknologi. Memulai dari eksplorasi AI dan berkembang ke pengembangan web. Berfokus pada antarmuka yang konsisten, rapi, dan mudah digunakan.";
      if(navigator.clipboard && window.isSecureContext){
        navigator.clipboard.writeText(bio).catch(()=>{});
      }else{
        const ta=document.createElement("textarea");
        ta.value=bio;
        document.body.appendChild(ta);
        ta.select();
        try{ document.execCommand("copy"); }catch(e){}
        ta.remove();
      }
    }

    function startClock(){
      const clock = document.getElementById('clockText');
      const sub = document.getElementById('clockSub');

      function tick(){
        const d = new Date();
        const hh = String(d.getHours()).padStart(2,'0');
        const mm = String(d.getMinutes()).padStart(2,'0');
        const ss = String(d.getSeconds()).padStart(2,'0');
        const day = d.toLocaleDateString('id-ID', { weekday:'long', year:'numeric', month:'short', day:'numeric' });

        if(clock) clock.textContent = `${hh}:${mm}:${ss}`;
        if(sub) sub.textContent = day;
      }
      tick();
      setInterval(tick, 1000);
    }

    function initSettingsUI(){
      const themeToggle = document.getElementById("themeToggle");
      const motionToggle = document.getElementById("motionToggle");
      const autoCloseToggle = document.getElementById("autoCloseToggle");

      const savedTheme = localStorage.getItem(PREF_THEME) || "light";
      const savedMotion = localStorage.getItem(PREF_MOTION) || "on";
      const savedAutoClose = localStorage.getItem(PREF_AUTOCLOSE) || "on";

      applyTheme(savedTheme);
      applyMotion(savedMotion !== "off");
      applyAutoClose(savedAutoClose !== "off");

      if(themeToggle) themeToggle.checked = (savedTheme === "dark");
      if(motionToggle) motionToggle.checked = (savedMotion !== "off");
      if(autoCloseToggle) autoCloseToggle.checked = (savedAutoClose !== "off");

      themeToggle?.addEventListener("change", ()=> applyTheme(themeToggle.checked ? "dark" : "light"));
      motionToggle?.addEventListener("change", ()=> applyMotion(motionToggle.checked));
      autoCloseToggle?.addEventListener("change", ()=> applyAutoClose(autoCloseToggle.checked));
    }

    // ===== UPDATED STATS (NEW GRAPH CONCEPT) =====
    function renderBars(nodes, values){
      const max = Math.max(...values, 1);
      nodes.forEach((bar, i)=>{
        const v = values[i] || 0;
        bar.style.height = (v / max * 100) + "%";
        const span = bar.querySelector("span");
        if(span) span.textContent = v;
      });
    }

    async function loadStats(){
      try{
        const res = await fetch("/api/status");
        const data = await res.json();

        const visitors = [
          data.visitors.today,
          data.visitors.d1,
          data.visitors.d3,
          data.visitors.d7,
          data.visitors.d30
        ];

        const uploads = [
          data.uploads.today,
          data.uploads.d1,
          data.uploads.d3,
          data.uploads.d7,
          data.uploads.d30
        ];

        renderBars(document.querySelectorAll(".visitor-bar"), visitors);
        renderBars(document.querySelectorAll(".upload-bar"), uploads);

        // KPI updates (same layout)
        document.getElementById("kpiStatus").textContent = data.status || "ONLINE";
        document.getElementById("kpiTotal").textContent = data.visitors.today || 0;
        document.getElementById("kpiUploads").textContent = data.uploads.today || 0;

      }catch(err){
        console.log("Stats error");
      }
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      mountTools();
      initSettingsUI();
      startClock();
      showTool('dashboard');

      fetch("/api/visit").catch(()=>{});
      loadStats();
      setInterval(loadStats, 5000);
    });

    document.addEventListener('click', (e)=>{
      const sidebar=document.getElementById('sidebar');
      const mobileToggle=document.querySelector('.mobile-toggle');
      if(window.innerWidth<=768 &&
         sidebar.classList.contains('active') &&
         !sidebar.contains(e.target) &&
         e.target!==mobileToggle &&
         !mobileToggle.contains(e.target)){
        closeSidebar();
      }
    });
  </script>
</body>
  </html>
